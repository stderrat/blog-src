{{/* Related Articles - Uses Hugo's built-in Related Content feature */}}
{{- $related := .Site.RegularPages.Related . | first 4 -}}

{{ with $related }}
<section class="related-articles" aria-labelledby="related-heading">
    <h3 id="related-heading"><i class="fas fa-link"></i> Related Articles</h3>
    <div class="related-grid">
        {{ range . }}
        <a href="{{ .RelPermalink }}" class="related-card no-highlight{{ if not .Params.featured_image }} no-image{{ end }}">
            {{/* Only show image container if featured_image exists */}}
            {{ with .Params.featured_image }}
            <div class="related-card-image">
                <img src="{{ . }}" alt="Featured image for {{ $.Title }}" loading="lazy" class="inline" width="300" height="120">
            </div>
            {{ end }}
            <div class="related-card-content">
                <span class="related-card-category">
                    {{ with .Params.categories }}{{ index . 0 }}{{ end }}
                </span>
                <span class="related-card-title">{{ .Title }}</span>
                <span class="related-card-meta">
                    <time datetime="{{ .Date.Format "2006-01-02" }}">
                        {{ .Date.Format "Jan 2, 2006" }}
                    </time>
                    {{ if .Params.authors }}
                    <span class="related-card-author">
                        Â· {{ index .Params.authors 0 }}
                    </span>
                    {{ end }}
                </span>
            </div>
        </a>
        {{ end }}
    </div>
</section>
{{ end }}
