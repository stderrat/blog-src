<!-- Was this helpful? Feedback Widget -->
<div class="feedback-widget" id="feedback-widget">
    <div class="feedback-question">
        <span class="feedback-text">Was this article helpful?</span>
        <div class="feedback-buttons">
            <button class="feedback-btn feedback-yes" id="feedback-yes" title="Yes, this was helpful" aria-label="Yes, this was helpful">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
                </svg>
                <span>Yes</span>
            </button>
            <button class="feedback-btn feedback-no" id="feedback-no" title="No, this needs improvement" aria-label="No, this needs improvement">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"></path>
                </svg>
                <span>No</span>
            </button>
        </div>
    </div>
    <div class="feedback-response" id="feedback-response" style="display: none;">
        <span class="feedback-thanks" id="feedback-thanks"></span>
    </div>
</div>

<script>
(function() {
    const widget = document.getElementById('feedback-widget');
    const question = widget.querySelector('.feedback-question');
    const response = document.getElementById('feedback-response');
    const thanks = document.getElementById('feedback-thanks');
    const btnYes = document.getElementById('feedback-yes');
    const btnNo = document.getElementById('feedback-no');
    
    // Check if already voted (using localStorage)
    const pageId = window.location.pathname;
    const voted = localStorage.getItem('feedback-' + pageId);
    
    if (voted) {
        question.style.display = 'none';
        response.style.display = 'flex';
        thanks.textContent = 'Thank you for your feedback!';
    }
    
    function handleFeedback(isHelpful) {
        const feedbackType = isHelpful ? 'helpful' : 'not-helpful';
        
        // Store in localStorage to prevent multiple votes
        localStorage.setItem('feedback-' + pageId, feedbackType);
        
        // Optional: Send to Google Analytics if available
        if (typeof gtag === 'function') {
            gtag('event', 'feedback', {
                'event_category': 'Article Feedback',
                'event_label': pageId,
                'value': isHelpful ? 1 : 0
            });
        }
        
        // Optional: Send to Plausible if available
        if (typeof plausible === 'function') {
            plausible('Feedback', { props: { helpful: isHelpful, page: pageId } });
        }
        
        // Show thank you message
        question.style.display = 'none';
        response.style.display = 'flex';
        thanks.textContent = isHelpful 
            ? 'Glad this helped! Thank you for the feedback.' 
            : 'Thank you! We\'ll work on improving this article.';
        
        // Add animation class
        response.classList.add('feedback-animate');
    }
    
    btnYes.addEventListener('click', function() {
        handleFeedback(true);
    });
    
    btnNo.addEventListener('click', function() {
        handleFeedback(false);
    });
})();
</script>

